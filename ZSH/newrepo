#!/bin/bash

# Function to display verbose messages
verbose() {
  if [ "$verbose_mode" = true ]; then
    echo "$@"
  fi
}

# Parse options
verbose_mode=false
remote_url=""
repo_name=""
readme_content=""

while [[ "$1" =~ ^- ]]; do
  case $1 in
    -v | --verbose)
      verbose_mode=true
      ;;
    -r | --remote)
      shift
      remote_url="$1"
      ;;
    -n | --name)
      shift
      repo_name="$1"
      ;;
    -d | --description)
      shift
      readme_content="$1"
      ;;
    *)
      echo "Invalid option: $1"
      exit 1
      ;;
  esac
  shift
done

# Create a new directory if a name is provided
if [ -n "$repo_name" ]; then
  verbose "Creating directory '$repo_name'..."
  mkdir "$repo_name"
  cd "$repo_name" || exit
else
  repo_name=$(basename "$(pwd)")
fi

# Initialize a new Git repository
verbose "Initializing a new Git repository..."
git init

# Create a README.md file with optional description
echo "# $repo_name" > README.md
if [ -n "$readme_content" ]; then
  echo -e "\n$readme_content" >> README.md
fi
verbose "Creating initial commit..."
git add README.md
git commit -m "Initial commit"

# Add remote repository if URL is provided
if [ -n "$remote_url" ]; then
  verbose "Adding remote repository..."
  git remote add origin "$remote_url"
  verbose "Pushing initial commit to remote repository..."
  git push -u origin master
fi

echo "New repository setup complete."
